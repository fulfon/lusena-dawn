<section
  class="relative w-full overflow-hidden lusena-hero"
  style="--lusena-hero-mobile-max-height: {{ section.settings.mobile_max_height_px | default: 900 }}px; --lusena-hero-button-height-mobile: {{ section.settings.button_height_mobile_px | default: 56 }}px; --lusena-hero-button-font-size-mobile: {{ section.settings.button_text_size_mobile_px | default: 16 }}px;"
>
  {%- liquid
    assign desktop_image = section.settings.image_desktop
    if desktop_image == blank
      assign desktop_image = section.settings.image
    endif

    assign mobile_image = section.settings.image_mobile
    if mobile_image == blank
      assign mobile_image = desktop_image
    endif

    assign content_position = section.settings.content_position
    if content_position == blank
      assign content_position = 'lower'
    endif

    assign overlay_opacity = section.settings.overlay_opacity | default: 50

    assign content_position_mobile = section.settings.content_position_mobile | default: content_position
    assign content_position_desktop = section.settings.content_position_desktop | default: content_position

    assign content_offset_y = section.settings.content_offset_y | default: 0
    assign content_offset_y_mobile = section.settings.content_offset_y_mobile | default: content_offset_y
    assign content_offset_y_desktop = section.settings.content_offset_y_desktop | default: content_offset_y
  -%}

  <div class="absolute inset-0 h-full w-full z-0" data-lusena-hero-image>
    {%- if mobile_image != blank or desktop_image != blank -%}
      <picture>
        {%- if desktop_image != blank -%}
          <source
            media="(min-width: 768px)"
            sizes="100vw"
            srcset="
              {{ desktop_image | image_url: width: 750 }} 750w,
              {{ desktop_image | image_url: width: 1100 }} 1100w,
              {{ desktop_image | image_url: width: 1500 }} 1500w,
              {{ desktop_image | image_url: width: 2000 }} 2000w,
              {{ desktop_image | image_url: width: 3000 }} 3000w
            "
          >
        {%- endif -%}

        {{
          mobile_image
          | image_url: width: 2000
          | image_tag:
            class: 'h-full w-full object-cover',
            widths: '375, 550, 750, 1100, 1500, 2000',
            sizes: '100vw',
            loading: 'eager',
            fetchpriority: 'high'
        }}
      </picture>
    {%- else -%}
      {{ 'lifestyle-2' | placeholder_svg_tag: 'h-full w-full object-cover bg-surface-2' }}
    {%- endif -%}
  </div>

  <div
    class="absolute inset-0 z-10 pointer-events-none"
    style="background-color: rgb(0 0 0 / {{ overlay_opacity }}%);"
    aria-hidden="true"
  >
    &#8203;
  </div>

<div
  class="container relative h-full flex flex-col z-20 lusena-hero__content lusena-hero__content--m-{{ content_position_mobile }} lusena-hero__content--d-{{ content_position_desktop }}"
  style="--lusena-hero-text-offset-y-mobile-px: {{ content_offset_y_mobile }}px; --lusena-hero-text-offset-y-mobile-vh: {{ section.settings.content_offset_y_mobile_vh | default: 0 }}; --lusena-hero-stack-offset-y-desktop-px: {{ content_offset_y_desktop }}px; --lusena-hero-buttons-offset-y-mobile-px: {{ section.settings.buttons_offset_y_mobile_px | default: 0 }}px; --lusena-hero-buttons-offset-y-mobile-vh: {{ section.settings.buttons_offset_y_mobile_vh | default: 0 }};"
>
  {%- liquid
    assign heading_block = section.blocks | where: 'type', 'heading' | first
    assign subheading_block = section.blocks | where: 'type', 'subheading' | first
    assign buttons_block = section.blocks | where: 'type', 'buttons' | first

    assign has_text = false
    if heading_block != blank and heading_block.settings.heading != blank
      assign has_text = true
    endif
    if subheading_block != blank and subheading_block.settings.text != blank
      assign has_text = true
    endif

    assign has_buttons = false
    if buttons_block != blank
      if buttons_block.settings.button_label_1 != blank
        assign has_buttons = true
      endif
      if buttons_block.settings.button_label_2 != blank
        assign has_buttons = true
      endif
    endif
  -%}

  <div class="max-w-xl pl-4 md:pl-0 lusena-hero__stack" data-lusena-hero-text>
    {%- if has_text -%}
      <div class="lusena-hero__text-wrap">
        <div class="space-y-6 md:space-y-8 lusena-hero__text">
          {%- if heading_block != blank and heading_block.settings.heading != blank -%}
            <h1 class="text-5xl md:text-7xl lg:text-8xl font-serif italic tracking-tight text-white drop-shadow-sm" {{ heading_block.shopify_attributes }}>
              {{ heading_block.settings.heading }}
            </h1>
          {%- endif -%}

          {%- if subheading_block != blank and subheading_block.settings.text != blank -%}
            <p class="text-lg md:text-xl font-light text-white/95 max-w-md leading-relaxed drop-shadow-sm" {{ subheading_block.shopify_attributes }}>
              {{ subheading_block.settings.text | escape }}
            </p>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}

    {%- if has_buttons -%}
      <div class="lusena-hero__buttons-wrap" {{ buttons_block.shopify_attributes }}>
        <div class="pt-4 flex flex-col sm:flex-row gap-4 lusena-hero__buttons">
          {%- if buttons_block.settings.button_label_1 != blank -%}
            <a
              {% if buttons_block.settings.button_link_1 == blank %}
                role="link" aria-disabled="true"
              {% else %}
                href="{{ buttons_block.settings.button_link_1 }}"
              {% endif %}
              class="lusena-hero__button inline-flex items-center justify-center whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary/20 disabled:pointer-events-none disabled:opacity-50 uppercase tracking-widest px-10 bg-white text-accent-cta hover:bg-white/90 border-none w-full sm:w-auto min-w-[180px]"
            >
              {{ buttons_block.settings.button_label_1 | escape }}
            </a>
          {%- endif -%}

          {%- if buttons_block.settings.button_label_2 != blank -%}
            <a
              {% if buttons_block.settings.button_link_2 == blank %}
                role="link" aria-disabled="true"
              {% else %}
                href="{{ buttons_block.settings.button_link_2 }}"
              {% endif %}
              class="lusena-hero__button inline-flex items-center justify-center whitespace-nowrap font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary/20 disabled:pointer-events-none disabled:opacity-50 uppercase tracking-widest px-10 border border-white bg-transparent text-white hover:bg-white/20 hover:text-white w-full sm:w-auto min-w-[160px]"
            >
              {{ buttons_block.settings.button_label_2 | escape }}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}
  </div>
</div>
</section>

{% stylesheet %}
  .lusena-hero {
    height: 85vh;
    min-height: 600px;
  }

  @media (max-width: 767px) {
    .lusena-hero {
      min-height: 0;
      height: min(85vh, var(--lusena-hero-mobile-max-height));
    }

    .lusena-hero [data-lusena-hero-image] img {
      object-position: bottom;
    }
  }

  @media (min-width: 768px) {
    .lusena-hero [data-lusena-hero-image] img {
      object-position: center;
    }
  }

  .lusena-hero__button {
    height: var(--lusena-hero-button-height-mobile, 56px);
    font-size: var(--lusena-hero-button-font-size-mobile, 16px);
  }

  @media (min-width: 768px) {
    .lusena-hero__button {
      height: 56px;
      font-size: 16px;
    }
  }

  .lusena-hero__content {
    justify-content: center;
    padding-top: 0;
    padding-bottom: 0;
  }

  .lusena-hero__stack {
    width: 100%;
  }

  .lusena-hero__text {
    transform: translateY(calc(var(--lusena-hero-text-offset-y-mobile-px, 0px) + (var(--lusena-hero-text-offset-y-mobile-vh, 0) * 1vh)));
  }

  .lusena-hero__buttons {
    transform: translateY(calc(var(--lusena-hero-buttons-offset-y-mobile-px, 0px) + (var(--lusena-hero-buttons-offset-y-mobile-vh, 0) * 1vh)));
  }

  .lusena-hero__content--m-top {
    justify-content: flex-start;
    padding-top: 7.2rem;
    padding-bottom: 0;
  }

  .lusena-hero__content--m-center {
    justify-content: center;
    padding-top: 0;
    padding-bottom: 0;
  }

  .lusena-hero__content--m-lower {
    justify-content: flex-end;
    padding-top: 0;
    padding-bottom: 7.2rem;
  }

  .lusena-hero__content--m-bottom {
    justify-content: flex-end;
    padding-top: 0;
    padding-bottom: 3.6rem;
  }

  @media (min-width: 768px) {
    .lusena-hero__stack {
      transform: translateY(var(--lusena-hero-stack-offset-y-desktop-px, 0px));
    }

    .lusena-hero__text {
      transform: none;
    }

    .lusena-hero__buttons {
      transform: none;
    }
  }

  @media (min-width: 768px) {
    .lusena-hero__content--d-top {
      justify-content: flex-start;
      padding-top: 6rem;
      padding-bottom: 0;
    }

    .lusena-hero__content--d-center {
      justify-content: center;
      padding-top: 0;
      padding-bottom: 0;
    }

    .lusena-hero__content--d-lower {
      justify-content: flex-end;
      padding-top: 0;
      padding-bottom: 10rem;
    }

    .lusena-hero__content--d-bottom {
      justify-content: flex-end;
      padding-top: 0;
      padding-bottom: 5rem;
    }

  }
{% endstylesheet %}

{% schema %}
{
  "name": "LUSENA hero (draft)",
  "tag": "section",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Hero image (legacy/fallback)"
    },
    {
      "type": "image_picker",
      "id": "image_desktop",
      "label": "Hero image (desktop)"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Hero image (mobile)"
    },
    {
      "type": "range",
      "id": "mobile_max_height_px",
      "min": 320,
      "max": 1200,
      "step": 10,
      "unit": "px",
      "label": "Mobile hero max height",
      "default": 900
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 90,
      "step": 1,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 50
    },
    {
      "type": "header",
      "content": "Buttons — mobile"
    },
    {
      "type": "range",
      "id": "button_height_mobile_px",
      "min": 44,
      "max": 84,
      "step": 2,
      "unit": "px",
      "label": "Button height (mobile)",
      "default": 56
    },
    {
      "type": "range",
      "id": "button_text_size_mobile_px",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button text size (mobile)",
      "default": 16
    },
    {
      "type": "range",
      "id": "buttons_offset_y_mobile_px",
      "min": -120,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Buttons fine-tune (Y offset) (mobile)",
      "default": 0
    },
    {
      "type": "range",
      "id": "buttons_offset_y_mobile_vh",
      "min": -20,
      "max": 20,
      "step": 1,
      "unit": "vh",
      "label": "Buttons fine-tune (Y offset) (mobile, relative)",
      "default": 0
    },
    {
      "type": "header",
      "content": "Text position — mobile"
    },
    {
      "type": "radio",
      "id": "content_position_mobile",
      "label": "Text vertical position (mobile)",
      "default": "lower",
      "options": [
        { "value": "top", "label": "Top" },
        { "value": "center", "label": "Center" },
        { "value": "lower", "label": "Lower" },
        { "value": "bottom", "label": "Bottom" }
      ]
    },
    {
      "type": "range",
      "id": "content_offset_y_mobile",
      "min": -120,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Text fine-tune (Y offset) (mobile)",
      "default": 0
    },
    {
      "type": "range",
      "id": "content_offset_y_mobile_vh",
      "min": -20,
      "max": 20,
      "step": 1,
      "unit": "vh",
      "label": "Text fine-tune (Y offset) (mobile, relative)",
      "default": 0
    },
    {
      "type": "header",
      "content": "Text position — desktop"
    },
    {
      "type": "radio",
      "id": "content_position_desktop",
      "label": "Text vertical position (desktop)",
      "default": "lower",
      "options": [
        { "value": "top", "label": "Top" },
        { "value": "center", "label": "Center" },
        { "value": "lower", "label": "Lower" },
        { "value": "bottom", "label": "Bottom" }
      ]
    },
    {
      "type": "range",
      "id": "content_offset_y_desktop",
      "min": -120,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Text fine-tune (Y offset) (desktop)",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "Heading",
      "limit": 1,
      "settings": [
        {
          "type": "richtext",
          "id": "heading",
          "label": "Heading",
          "default": "<p>Beauty Happens<br>at Night.</p>"
        }
      ]
    },
    {
      "type": "subheading",
      "name": "Subheading",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Obudź się piękniejsza. Jedwab 22 momme z Suzhou, który chroni Twoją skórę przez całą noc."
        }
      ]
    },
    {
      "type": "buttons",
      "name": "Buttons",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "button_label_1",
          "label": "Primary button label",
          "default": "Shop Pillowcases"
        },
        {
          "type": "url",
          "id": "button_link_1",
          "label": "Primary button link"
        },
        {
          "type": "text",
          "id": "button_label_2",
          "label": "Secondary button label",
          "default": "Why Silk?"
        },
        {
          "type": "url",
          "id": "button_link_2",
          "label": "Secondary button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "LUSENA hero (draft)",
      "blocks": [
        {
          "type": "heading"
        },
        {
          "type": "subheading"
        },
        {
          "type": "buttons",
          "settings": {
            "button_link_1": "shopify://collections/all",
            "button_link_2": "shopify://pages/nasza-jakosc"
          }
        }
      ]
    }
  ]
}
{% endschema %}
