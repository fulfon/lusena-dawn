{%- paginate collection.products by section.settings.products_per_page -%}
  <div class="container py-12">
    <div class="flex flex-col md:flex-row justify-between items-baseline mb-8">
      <div>
        <h1 class="text-3xl md:text-4xl font-serif text-primary">{{ collection.title | escape }}</h1>
        {%- if collection.description != blank -%}
          <p class="text-secondary mt-2">{{ collection.description | strip_html }}</p>
        {%- else -%}
          <p class="text-secondary mt-2">{{ section.settings.default_description | escape }}</p>
        {%- endif -%}
      </div>

      <div class="flex items-center gap-4 mt-4 md:mt-0">
        <span class="text-sm text-secondary">
          {{ collection.products_count }} {{ collection.products_count | pluralize: 'Product', 'Products' }}
        </span>
        <button type="button" class="hidden md:flex inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary/20 disabled:pointer-events-none disabled:opacity-50 uppercase tracking-widest h-9 px-4 text-xs border border-primary bg-transparent text-primary hover:bg-surface-2">
          Filter &amp; Sort
        </button>
      </div>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-4 gap-y-12 md:gap-8">
      {%- for product in collection.products -%}
        {% render 'lusena-product-card', product: product, show_secondary_image: section.settings.show_secondary_image %}
      {%- endfor -%}
    </div>

    <div class="mt-16 text-center">
      {%- if paginate.next -%}
        <a
          href="{{ paginate.next.url }}"
          class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary/20 disabled:pointer-events-none disabled:opacity-50 uppercase tracking-widest h-12 px-8 py-3 border border-primary bg-transparent text-primary hover:bg-surface-2 min-w-[200px]"
        >
          Load More
        </a>
      {%- else -%}
        <span class="text-sm text-secondary">No more products.</span>
      {%- endif -%}
    </div>
  </div>
{%- endpaginate -%}

{% schema %}
{
  "name": "LUSENA collection (draft)",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 4,
      "max": 36,
      "step": 4,
      "label": "Products per page",
      "default": 16
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "label": "Show hover image",
      "default": true
    },
    {
      "type": "text",
      "id": "default_description",
      "label": "Fallback description",
      "default": "Premium mulberry silk for better sleep."
    }
  ],
  "presets": [
    {
      "name": "LUSENA collection (draft)"
    }
  ]
}
{% endschema %}

